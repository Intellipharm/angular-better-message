!function(){"use strict";angular.module("AngularBetterMessage",[])}(),angular.module("AngularBetterMessage",[]).run(["$templateCache",function(e){e.put("html/angular-better-message.html",'<div class="angular-better-message" ng-class="[state, outer_prompt_class]" ng-show="is_visible"><div ng-class="message_class"><span ng-class="message_icon_class"></span> <span class="angular-better-message-wrapper"></span> <span class="countdown" ng-if="show_count_down">{{count_down}}</span></div><div ng-if="prompt" ng-class="prompt_class"><button ng-class="prompt_button_class" ng-click="ctrl.onClick()">{{prompt}} <span ng-class="prompt_icon_class"></span></button></div></div>')}]),function(){"use strict";var e=function(e){this.onClick=function(){if(!_.isUndefined(e.onClick)){var s=_.isUndefined(e.message)?null:e.message,n=_.isUndefined(e.state)?null:e.state,t=_.isUndefined(e.key)?null:e.key,a=_.isUndefined(e.data)?null:e.data;e.onClick({message:s,state:n,key:t,data:a})}e.close()}};e.$inject=["$scope"],angular.module("AngularBetterMessage").controller("AngularBetterMessageCtrl",e)}(),function(){"use strict";var e=function(e,s,n,t,a,o){return{restrict:"EA",scope:{api:"=",message:"=",state:"=",key:"=",data:"=",message_icon_class:"=messageIconClass",prompt:"=",prompt_button_class:"=promptButtonClass",prompt_icon_class:"=promptIconClass",display_seconds:"=displaySeconds",show_count_down:"=showCountDown",fixed_position_on_scroll:"=fixedPositionOnScroll",onClick:"&onPromptClick"},controller:"AngularBetterMessageCtrl as ctrl",link:function(c,i,l,r){var p=c.api||{};c.message_class=t,c.prompt_class=a;var u,d,g;c.is_visible=!1;var m,f=angular.element(e);p.close=function(){c.close()},p.update=function(){c.update()},c.close=function(){c.is_visible=!1},c.wait=function(){u=s(function(){0===--c.count_down?(s.cancel(u),c.close()):c.wait()},1e3)},c.checkPosition=function(){c.is_visible&&!i.hasClass("detached")&&_.isNull(i[0].offsetParent)?d=s(c.checkPosition,100):(g=i[0].getBoundingClientRect().top,c.updateDetached())},c.updateDetached=function(){s.cancel(d),!i.hasClass("detached")&&0>=g&&e.pageYOffset>0?(m=e.pageYOffset,i.addClass("detached")):i.hasClass("detached")&&!_.isUndefined(m)&&e.pageYOffset<=m&&i.removeClass("detached")},c.update=function(){c.is_visible=!0,c.fixed_position_on_scroll&&c.checkPosition(),c.count_down=_.parseInt(c.display_seconds),s.cancel(u),_.isUndefined(c.count_down)||0===c.count_down||(c.wait(),c.outer_prompt_class=o)},c.$watch("display_seconds",function(e){_.isUndefined(e)||""===e||(c.display_seconds=_.parseInt(e),c.count_down=_.parseInt(e))}),c.$watch("message",function(e){var t=angular.element(i[0].querySelector(".angular-better-message-wrapper"));if(t.empty(),_.isUndefined(e)||""===e)s.cancel(u),c.close();else{var a=n("<span>"+e+"</span>")(c.$parent.$parent);t.append(a),c.update()}}),c.$watch("prompt",function(e){_.isUndefined(e)||""===e?c.outer_prompt_class="":c.outer_prompt_class=o}),c.fixed_position_on_scroll&&f.on("scroll",function(){_.isUndefined(c.message)||""===c.message||c.checkPosition()})},replace:!0,templateUrl:"html/angular-better-message.html"}};e.$inject=["$window","$timeout","$compile","ANGULAR_BETTER_MESSAGE_CLASS","ANGULAR_BETTER_MESSAGE_PROMPT_CLASS","ANGULAR_BETTER_MESSAGE_HAS_PROMPT_CLASS"],angular.module("AngularBetterMessage").directive("angularBetterMessage",e)}(),function(){"use strict";angular.module("AngularBetterMessage").constant("ANGULAR_BETTER_MESSAGE_CLASS","message").constant("ANGULAR_BETTER_MESSAGE_PROMPT_CLASS","prompt").constant("ANGULAR_BETTER_MESSAGE_HAS_PROMPT_CLASS","has-prompt")}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UuanMiLCJhbmd1bGFyLWJldHRlci1tZXNzYWdlLXRlbXBsYXRlcy5qcyIsImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UtY29udHJvbGxlci5qcyIsImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UtZGlyZWN0aXZlLmpzIiwiYW5ndWxhci1iZXR0ZXItbWVzc2FnZS1zZXR0aW5ncy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJHRlbXBsYXRlQ2FjaGUiLCJwdXQiLCJjb250cm9sbGVyIiwiJHMiLCJ0aGlzIiwib25DbGljayIsIl8iLCJpc1VuZGVmaW5lZCIsIm1lc3NhZ2UiLCJzdGF0ZSIsImtleSIsImRhdGEiLCJjbG9zZSIsIiRpbmplY3QiLCJkaXJlY3RpdmUiLCIkd2luZG93IiwiJHRpbWVvdXQiLCIkY29tcGlsZSIsIk1FU1NBR0VfQ0xBU1MiLCJQUk9NUFRfQ0xBU1MiLCJIQVNfUFJPTVBUX0NMQVNTIiwicmVzdHJpY3QiLCJzY29wZSIsImFwaSIsIm1lc3NhZ2VfaWNvbl9jbGFzcyIsInByb21wdCIsInByb21wdF9idXR0b25fY2xhc3MiLCJwcm9tcHRfaWNvbl9jbGFzcyIsImRpc3BsYXlfc2Vjb25kcyIsInNob3dfY291bnRfZG93biIsImZpeGVkX3Bvc2l0aW9uX29uX3Njcm9sbCIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJtZXNzYWdlX2NsYXNzIiwicHJvbXB0X2NsYXNzIiwid2FpdF90aW1lciIsImVsZW1lbnRfdmlzaWJsZV90aW1lciIsImVsZW1lbnRfdG9wIiwiaXNfdmlzaWJsZSIsImRldGFjaGVkX3Bvc2l0aW9uIiwid2luZG93X2VsZW1lbnQiLCJ1cGRhdGUiLCJ3YWl0IiwiY291bnRfZG93biIsImNhbmNlbCIsImNoZWNrUG9zaXRpb24iLCJoYXNDbGFzcyIsImlzTnVsbCIsIm9mZnNldFBhcmVudCIsImdldEJvdW5kaW5nQ2xpZW50UmVjdCIsInRvcCIsInVwZGF0ZURldGFjaGVkIiwicGFnZVlPZmZzZXQiLCJhZGRDbGFzcyIsInJlbW92ZUNsYXNzIiwicGFyc2VJbnQiLCJvdXRlcl9wcm9tcHRfY2xhc3MiLCIkd2F0Y2giLCJ2YWwiLCJ3cmFwcGVyIiwicXVlcnlTZWxlY3RvciIsImVtcHR5IiwiY29tcGlsZWRfbWVzc2FnZSIsIiRwYXJlbnQiLCJhcHBlbmQiLCJvbiIsInJlcGxhY2UiLCJ0ZW1wbGF0ZVVybCIsImNvbnN0YW50Il0sIm1hcHBpbmdzIjoiQ0FBQSxXQUVBLFlBTUFBLFNBQUFDLE9BQUEsOEJDUkFELFFBQUFDLE9BQUEsMkJBQUFDLEtBQUEsaUJBQUEsU0FBQUMsR0FBQUEsRUFBQUMsSUFBQSxtQ0FBQSx3ZUNBQSxXQUVBLFlBTUEsSUFBQUMsR0FBQSxTQUFBQyxHQUtBQyxLQUFBQyxRQUFBLFdBQ0EsSUFBQUMsRUFBQUMsWUFBQUosRUFBQUUsU0FBQSxDQUVBLEdBQUFHLEdBQUFGLEVBQUFDLFlBQUFKLEVBQUFLLFNBQUEsS0FBQUwsRUFBQUssUUFDQUMsRUFBQUgsRUFBQUMsWUFBQUosRUFBQU0sT0FBQSxLQUFBTixFQUFBTSxNQUNBQyxFQUFBSixFQUFBQyxZQUFBSixFQUFBTyxLQUFBLEtBQUFQLEVBQUFPLElBQ0FDLEVBQUFMLEVBQUFDLFlBQUFKLEVBQUFRLE1BQUEsS0FBQVIsRUFBQVEsSUFFQVIsR0FBQUUsU0FBQUcsUUFBQUEsRUFBQUMsTUFBQUEsRUFBQUMsSUFBQUEsRUFBQUMsS0FBQUEsSUFFQVIsRUFBQVMsU0FJQVYsR0FBQVcsU0FBQSxVQUVBaEIsUUFBQUMsT0FBQSx3QkFBQUksV0FBQSwyQkFBQUEsTUM3QkEsV0FFQSxZQU1BLElBQUFZLEdBQUEsU0FDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsRUFDQUMsR0FlQSxPQUNBQyxTQUFBLEtBQ0FDLE9BQ0FDLElBQUEsSUFDQWYsUUFBQSxJQUNBQyxNQUFBLElBQ0FDLElBQUEsSUFDQUMsS0FBQSxJQUNBYSxtQkFBQSxvQkFDQUMsT0FBQSxJQUNBQyxvQkFBQSxxQkFDQUMs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dWxhci1iZXR0ZXItbWVzc2FnZS50bXBsLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQW5ndWxhciBCZXR0ZXIgTWVzc2FnZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlJywgW10pO1xuXG59KSgpO1xuIiwiYW5ndWxhci5tb2R1bGUoXCJBbmd1bGFyQmV0dGVyTWVzc2FnZVwiLCBbXSkucnVuKFtcIiR0ZW1wbGF0ZUNhY2hlXCIsIGZ1bmN0aW9uKCR0ZW1wbGF0ZUNhY2hlKSB7JHRlbXBsYXRlQ2FjaGUucHV0KFwiaHRtbC9hbmd1bGFyLWJldHRlci1tZXNzYWdlLmh0bWxcIixcIjxkaXYgY2xhc3M9XFxcImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2VcXFwiIG5nLWNsYXNzPVxcXCJbc3RhdGUsIG91dGVyX3Byb21wdF9jbGFzc11cXFwiIG5nLXNob3c9XFxcImlzX3Zpc2libGVcXFwiPjxkaXYgbmctY2xhc3M9XFxcIm1lc3NhZ2VfY2xhc3NcXFwiPjxzcGFuIG5nLWNsYXNzPVxcXCJtZXNzYWdlX2ljb25fY2xhc3NcXFwiPjwvc3Bhbj4gPHNwYW4gY2xhc3M9XFxcImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2Utd3JhcHBlclxcXCI+PC9zcGFuPiA8c3BhbiBjbGFzcz1cXFwiY291bnRkb3duXFxcIiBuZy1pZj1cXFwic2hvd19jb3VudF9kb3duXFxcIj57e2NvdW50X2Rvd259fTwvc3Bhbj48L2Rpdj48ZGl2IG5nLWlmPVxcXCJwcm9tcHRcXFwiIG5nLWNsYXNzPVxcXCJwcm9tcHRfY2xhc3NcXFwiPjxidXR0b24gbmctY2xhc3M9XFxcInByb21wdF9idXR0b25fY2xhc3NcXFwiIG5nLWNsaWNrPVxcXCJjdHJsLm9uQ2xpY2soKVxcXCI+e3twcm9tcHR9fSA8c3BhbiBuZy1jbGFzcz1cXFwicHJvbXB0X2ljb25fY2xhc3NcXFwiPjwvc3Bhbj48L2J1dHRvbj48L2Rpdj48L2Rpdj5cIik7fV0pOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEFuZ3VsYXIgQmV0dGVyIE1lc3NhZ2UgY29udHJvbGxlclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHMpIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogb25DbGlja1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQoJHMub25DbGljaykpIHtcblxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gIV8uaXNVbmRlZmluZWQoJHMubWVzc2FnZSkgPyAkcy5tZXNzYWdlIDogbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSAhXy5pc1VuZGVmaW5lZCgkcy5zdGF0ZSkgPyAkcy5zdGF0ZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIGtleSA9ICFfLmlzVW5kZWZpbmVkKCRzLmtleSkgPyAkcy5rZXkgOiBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gIV8uaXNVbmRlZmluZWQoJHMuZGF0YSkgPyAkcy5kYXRhIDogbnVsbDtcblxuICAgICAgICAgICAgICAgICRzLm9uQ2xpY2soe21lc3NhZ2U6IG1lc3NhZ2UsIHN0YXRlOiBzdGF0ZSwga2V5OiBrZXksIGRhdGE6IGRhdGF9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQW5ndWxhckJldHRlck1lc3NhZ2UnKS5jb250cm9sbGVyKCdBbmd1bGFyQmV0dGVyTWVzc2FnZUN0cmwnLCBjb250cm9sbGVyKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gYW5ndWxhci1iZXR0ZXItbWVzc2FnZSBkaXJlY3RpdmVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHZhciBkaXJlY3RpdmUgPSBmdW5jdGlvbihcbiAgICAgICAgJHdpbmRvdyxcbiAgICAgICAgJHRpbWVvdXQsXG4gICAgICAgICRjb21waWxlLFxuICAgICAgICBNRVNTQUdFX0NMQVNTLFxuICAgICAgICBQUk9NUFRfQ0xBU1MsXG4gICAgICAgIEhBU19QUk9NUFRfQ0xBU1NcbiAgICApIHtcblxuICAgICAgICBmdW5jdGlvbiBnZXRQb3NpdGlvbihlbGVtZW50KSB7XG4gICAgICAgICAgICB2YXIgeFBvc2l0aW9uID0gMDtcbiAgICAgICAgICAgIHZhciB5UG9zaXRpb24gPSAwO1xuXG4gICAgICAgICAgICB3aGlsZShlbGVtZW50KSB7XG4gICAgICAgICAgICAgICAgeFBvc2l0aW9uICs9IChlbGVtZW50Lm9mZnNldExlZnQgLSBlbGVtZW50LnNjcm9sbExlZnQgKyBlbGVtZW50LmNsaWVudExlZnQpO1xuICAgICAgICAgICAgICAgIHlQb3NpdGlvbiArPSAoZWxlbWVudC5vZmZzZXRUb3AgLSBlbGVtZW50LnNjcm9sbFRvcCArIGVsZW1lbnQuY2xpZW50VG9wKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50ID0gZWxlbWVudC5vZmZzZXRQYXJlbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4geyB4OiB4UG9zaXRpb24sIHk6IHlQb3NpdGlvbiB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBhcGk6ICAgICAgICAgICAgICAgICAgICBcIj1cIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAgICAgICAgICAgICAgICBcIj1cIiwgLy8gd2lsbCBiZSBwYXNzZWQgYmFjayBvbiBldmVudHNcbiAgICAgICAgICAgICAgICBzdGF0ZTogICAgICAgICAgICAgICAgICBcIj1cIiwgLy8gd2lsbCBiZSBwYXNzZWQgYmFjayBvbiBldmVudHNcbiAgICAgICAgICAgICAgICBrZXk6ICAgICAgICAgICAgICAgICAgICBcIj1cIiwgLy8gd2lsbCBiZSBwYXNzZWQgYmFjayBvbiBldmVudHNcbiAgICAgICAgICAgICAgICBkYXRhOiAgICAgICAgICAgICAgICAgICBcIj1cIiwgLy8gd2lsbCBiZSBwYXNzZWQgYmFjayBvbiBldmVudHNcbiAgICAgICAgICAgICAgICBtZXNzYWdlX2ljb25fY2xhc3M6ICAgICBcIj1tZXNzYWdlSWNvbkNsYXNzXCIsXG4gICAgICAgICAgICAgICAgcHJvbXB0OiAgICAgICAgICAgICAgICAgXCI9XCIsXG4gICAgICAgICAgICAgICAgcHJvbXB0X2J1dHRvbl9jbGFzczogICAgXCI9cHJvbXB0QnV0dG9uQ2xhc3NcIixcbiAgICAgICAgICAgICAgICBwcm9tcHRfaWNvbl9jbGFzczogICAgICBcIj1wcm9tcHRJY29uQ2xhc3NcIixcbiAgICAgICAgICAgICAgICBkaXNwbGF5X3NlY29uZHM6ICAgICAgICBcIj1kaXNwbGF5U2Vjb25kc1wiLFxuICAgICAgICAgICAgICAgIHNob3dfY291bnRfZG93bjogICAgICAgIFwiPXNob3dDb3VudERvd25cIixcbiAgICAgICAgICAgICAgICBmaXhlZF9wb3NpdGlvbl9vbl9zY3JvbGw6IFwiPWZpeGVkUG9zaXRpb25PblNjcm9sbFwiLFxuICAgICAgICAgICAgICAgIG9uQ2xpY2s6ICAgICAgICAgICAgICAgIFwiJm9uUHJvbXB0Q2xpY2tcIlxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwiQW5ndWxhckJldHRlck1lc3NhZ2VDdHJsIGFzIGN0cmxcIixcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY29udHJvbGxlcikge1xuXG4gICAgICAgICAgICAgICAgdmFyIGFwaSA9IHNjb3BlLmFwaSB8fCB7fTtcblxuICAgICAgICAgICAgICAgIC8vIGNsYXNzZXNcbiAgICAgICAgICAgICAgICBzY29wZS5tZXNzYWdlX2NsYXNzID0gTUVTU0FHRV9DTEFTUztcbiAgICAgICAgICAgICAgICBzY29wZS5wcm9tcHRfY2xhc3MgPSBQUk9NUFRfQ0xBU1M7XG5cbiAgICAgICAgICAgICAgICAvLyBjb250cm9sXG4gICAgICAgICAgICAgICAgdmFyIHdhaXRfdGltZXI7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRfdmlzaWJsZV90aW1lcjtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudF90b3A7XG4gICAgICAgICAgICAgICAgc2NvcGUuaXNfdmlzaWJsZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgLy8gZml4IG9uIHNjcm9sbFxuICAgICAgICAgICAgICAgIHZhciBkZXRhY2hlZF9wb3NpdGlvbjtcbiAgICAgICAgICAgICAgICB2YXIgd2luZG93X2VsZW1lbnQgPSBhbmd1bGFyLmVsZW1lbnQoJHdpbmRvdyk7XG5cbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgLy8gYXBpXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgICAgICAgICAgYXBpLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIGFwaS51cGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICAvLyB1dGlsc1xuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIGNsb3NlXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgc2NvcGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuaXNfdmlzaWJsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiB3YWl0XG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgc2NvcGUud2FpdCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHdhaXRfdGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKC0tc2NvcGUuY291bnRfZG93biA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh3YWl0X3RpbWVyKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS53YWl0KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBjaGVja1Bvc2l0aW9uXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgc2NvcGUuY2hlY2tQb3NpdGlvbiA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaXMgdmlzaWJsZSAmIGlzIG5vdCBkZXRhY2hlZCAmIGlzIG5vdCByZWFkeVxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuaXNfdmlzaWJsZSAmJiAhZWxlbWVudC5oYXNDbGFzcygnZGV0YWNoZWQnKSAmJiBfLmlzTnVsbChlbGVtZW50WzBdLm9mZnNldFBhcmVudCkpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gd2FpdFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudF92aXNpYmxlX3RpbWVyID0gJHRpbWVvdXQoc2NvcGUuY2hlY2tQb3NpdGlvbiwgMTAwKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGVsZW1lbnQgdG9wIG9mZnNldFxuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudF90b3AgPSBlbGVtZW50WzBdLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXBkYXRlXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS51cGRhdGVEZXRhY2hlZCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIHVwZGF0ZURldGFjaGVkXG4gICAgICAgICAgICAgICAgICovXG4gICAgICAgICAgICAgICAgc2NvcGUudXBkYXRlRGV0YWNoZWQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjYW5jZWwgdGltZXJcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKGVsZW1lbnRfdmlzaWJsZV90aW1lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZWxlbWVudCBpcyBub3QgZGV0YWNoZWQgYW5kIGlzIGF0IHRoZSB0b3Agb2Ygdmlld3BvcnQsIHRoZW4gZGV0YWNoXG4gICAgICAgICAgICAgICAgICAgIGlmICghZWxlbWVudC5oYXNDbGFzcygnZGV0YWNoZWQnKSAmJiBlbGVtZW50X3RvcCA8PSAwICYmICR3aW5kb3cucGFnZVlPZmZzZXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhY2hlZF9wb3NpdGlvbiA9ICR3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdkZXRhY2hlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaXMgZGV0YWNoZWQgYW5kIGlzIGF0IG9yIGFib3ZlIGRldGFjaGVkIHBvc2l0aW9uLCB0aGVuIGF0dGFjaFxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdkZXRhY2hlZCcpICYmICFfLmlzVW5kZWZpbmVkKGRldGFjaGVkX3Bvc2l0aW9uKSAmJiAkd2luZG93LnBhZ2VZT2Zmc2V0IDw9IGRldGFjaGVkX3Bvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RldGFjaGVkX3Bvc2l0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZGV0YWNoZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiB1cGRhdGVcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBzZXQgdmlzaWJpbGl0eVxuICAgICAgICAgICAgICAgICAgICBzY29wZS5pc192aXNpYmxlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuZml4ZWRfcG9zaXRpb25fb25fc2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyByZXNldCBjb3VudCBkb3duXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmNvdW50X2Rvd24gPSBfLnBhcnNlSW50KHNjb3BlLmRpc3BsYXlfc2Vjb25kcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc3RvcCB0aW1lb3V0XG4gICAgICAgICAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh3YWl0X3RpbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBhdXRvIGNsb3NlIGFmdGVyIGludGVydmFsXG4gICAgICAgICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZChzY29wZS5jb3VudF9kb3duKSAmJiBzY29wZS5jb3VudF9kb3duICE9PSAwKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0YXJ0IHdhaXRcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLndhaXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IG91dGVyIHByb210IGNsYXNzXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vdXRlcl9wcm9tcHRfY2xhc3MgPSBIQVNfUFJPTVBUX0NMQVNTO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICAvLyB3YXRjaGVyc1xuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaCgnZGlzcGxheV9zZWNvbmRzJywgZnVuY3Rpb24odmFsKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHZhbCkgJiYgdmFsICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5kaXNwbGF5X3NlY29uZHMgPSBfLnBhcnNlSW50KHZhbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jb3VudF9kb3duID0gXy5wYXJzZUludCh2YWwpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ21lc3NhZ2UnLCBmdW5jdGlvbih2YWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHdyYXBwZXIgPSBhbmd1bGFyLmVsZW1lbnQoZWxlbWVudFswXS5xdWVyeVNlbGVjdG9yKCcuYW5ndWxhci1iZXR0ZXItbWVzc2FnZS13cmFwcGVyJykpO1xuICAgICAgICAgICAgICAgICAgICB3cmFwcGVyLmVtcHR5KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHZhbCkgJiYgdmFsICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGlsZWRfbWVzc2FnZSA9ICRjb21waWxlKCc8c3Bhbj4nICsgdmFsICsgJzwvc3Bhbj4nKShzY29wZS4kcGFyZW50LiRwYXJlbnQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5hcHBlbmQoY29tcGlsZWRfbWVzc2FnZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHdhaXRfdGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCdwcm9tcHQnLCBmdW5jdGlvbih2YWwpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBzZXQgb3V0ZXIgcHJvbXQgY2xhc3NcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHZhbCkgJiYgdmFsICE9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vdXRlcl9wcm9tcHRfY2xhc3MgPSBIQVNfUFJPTVBUX0NMQVNTO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUub3V0ZXJfcHJvbXB0X2NsYXNzID0gXCJcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIC8vIGV2ZW50c1xuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAgICAgICAgIC8vIHdpbmRvdyBzY3JvbGxcblxuICAgICAgICAgICAgICAgIGlmIChzY29wZS5maXhlZF9wb3NpdGlvbl9vbl9zY3JvbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93X2VsZW1lbnQub24oJ3Njcm9sbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHNjb3BlLm1lc3NhZ2UpICYmIHNjb3BlLm1lc3NhZ2UgIT09IFwiXCIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2hlY2tQb3NpdGlvbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9hbmd1bGFyLWJldHRlci1tZXNzYWdlLmh0bWwnXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGRpcmVjdGl2ZS4kaW5qZWN0ID0gW1xuICAgICAgICAnJHdpbmRvdycsXG4gICAgICAgICckdGltZW91dCcsXG4gICAgICAgICckY29tcGlsZScsXG4gICAgICAgICdBTkdVTEFSX0JFVFRFUl9NRVNTQUdFX0NMQVNTJyxcbiAgICAgICAgJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfUFJPTVBUX0NMQVNTJyxcbiAgICAgICAgJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfSEFTX1BST01QVF9DTEFTUydcbiAgICBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnYW5ndWxhckJldHRlck1lc3NhZ2UnLCBkaXJlY3RpdmUpO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQW5ndWxhciBCZXR0ZXIgTWVzc2FnZSBzZXR0aW5nc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlJylcbiAgICAgICAgLmNvbnN0YW50KCdBTkdVTEFSX0JFVFRFUl9NRVNTQUdFX0NMQVNTJywgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIilcbiAgICAgICAgLmNvbnN0YW50KCdBTkdVTEFSX0JFVFRFUl9NRVNTQUdFX1BST01QVF9DTEFTUycsICAgICAgICBcInByb21wdFwiKVxuICAgICAgICAuY29uc3RhbnQoJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfSEFTX1BST01QVF9DTEFTUycsICAgIFwiaGFzLXByb21wdFwiKTtcblxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
