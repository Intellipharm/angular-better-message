!function(){"use strict";angular.module("AngularBetterMessage",[])}(),angular.module("AngularBetterMessage",[]).run(["$templateCache",function(s){s.put("html/angular-better-message.html",'<div class="angular-better-message" ng-class="[state, outer_prompt_class]" ng-show="is_visible"><div ng-class="message_class"><span ng-class="message_icon_class"></span> {{message}} <span class="countdown" ng-if="show_count_down">{{count_down}}</span></div><div ng-if="prompt" ng-class="prompt_class"><button ng-class="prompt_button_class" ng-click="ctrl.onClick()">{{prompt}} <span ng-class="prompt_icon_class"></span></button></div></div>')}]),function(){"use strict";var s=function(s){this.onClick=function(){if(!_.isUndefined(s.onClick)){var e=_.isUndefined(s.message)?null:s.message,n=_.isUndefined(s.state)?null:s.state,t=_.isUndefined(s.key)?null:s.key,a=_.isUndefined(s.data)?null:s.data;s.onClick({message:e,state:n,key:t,data:a})}s.close()}};s.$inject=["$scope"],angular.module("AngularBetterMessage").controller("AngularBetterMessageCtrl",s)}(),function(){"use strict";var s=function(s,e,n,t,a){return{restrict:"EA",scope:{api:"=",message:"=",state:"=",key:"=",data:"=",message_icon_class:"=messageIconClass",prompt:"=",prompt_button_class:"=promptButtonClass",prompt_icon_class:"=promptIconClass",display_seconds:"=displaySeconds",show_count_down:"=showCountDown",fixed_position_on_scroll:"=fixedPositionOnScroll",onClick:"&onPromptClick"},controller:"AngularBetterMessageCtrl as ctrl",link:function(o,c,i,l){var r=o.api||{};o.message_class=n,o.prompt_class=t;var d,u,p;o.is_visible=!1;var g,m=angular.element(s);r.close=function(){o.close()},r.update=function(){o.update()},o.close=function(){o.is_visible=!1},o.wait=function(){d=e(function(){0===--o.count_down?(e.cancel(d),o.close()):o.wait()},1e3)},o.checkPosition=function(){o.is_visible&&!c.hasClass("detached")&&_.isNull(c[0].offsetParent)?u=e(o.checkPosition,100):(p=c[0].getBoundingClientRect().top,o.updateDetached())},o.updateDetached=function(){e.cancel(u),!c.hasClass("detached")&&0>=p&&s.pageYOffset>0?(g=s.pageYOffset,c.addClass("detached")):c.hasClass("detached")&&!_.isUndefined(g)&&s.pageYOffset<=g&&c.removeClass("detached")},o.update=function(){o.is_visible=!0,o.fixed_position_on_scroll&&o.checkPosition(),o.count_down=_.parseInt(o.display_seconds),e.cancel(d),_.isUndefined(o.count_down)||0===o.count_down||(o.wait(),o.outer_prompt_class=a)},o.$watch("display_seconds",function(s){_.isUndefined(s)||""===s||(o.display_seconds=_.parseInt(s),o.count_down=_.parseInt(s))}),o.$watch("message",function(s){_.isUndefined(s)||""===s?(e.cancel(d),o.close()):o.update()}),o.$watch("prompt",function(s){_.isUndefined(s)||""===s?o.outer_prompt_class="":o.outer_prompt_class=a}),o.fixed_position_on_scroll&&m.on("scroll",function(){_.isUndefined(o.message)||""===o.message||o.checkPosition()})},replace:!0,templateUrl:"html/angular-better-message.html"}};s.$inject=["$window","$timeout","ANGULAR_BETTER_MESSAGE_CLASS","ANGULAR_BETTER_MESSAGE_PROMPT_CLASS","ANGULAR_BETTER_MESSAGE_HAS_PROMPT_CLASS"],angular.module("AngularBetterMessage").directive("angularBetterMessage",s)}(),function(){"use strict";angular.module("AngularBetterMessage").constant("ANGULAR_BETTER_MESSAGE_CLASS","message").constant("ANGULAR_BETTER_MESSAGE_PROMPT_CLASS","prompt").constant("ANGULAR_BETTER_MESSAGE_HAS_PROMPT_CLASS","has-prompt")}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UuanMiLCJhbmd1bGFyLWJldHRlci1tZXNzYWdlLXRlbXBsYXRlcy5qcyIsImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UtY29udHJvbGxlci5qcyIsImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UtZGlyZWN0aXZlLmpzIiwiYW5ndWxhci1iZXR0ZXItbWVzc2FnZS1zZXR0aW5ncy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwicnVuIiwiJHRlbXBsYXRlQ2FjaGUiLCJwdXQiLCJjb250cm9sbGVyIiwiJHMiLCJ0aGlzIiwib25DbGljayIsIl8iLCJpc1VuZGVmaW5lZCIsIm1lc3NhZ2UiLCJzdGF0ZSIsImtleSIsImRhdGEiLCJjbG9zZSIsIiRpbmplY3QiLCJkaXJlY3RpdmUiLCIkd2luZG93IiwiJHRpbWVvdXQiLCJNRVNTQUdFX0NMQVNTIiwiUFJPTVBUX0NMQVNTIiwiSEFTX1BST01QVF9DTEFTUyIsInJlc3RyaWN0Iiwic2NvcGUiLCJhcGkiLCJtZXNzYWdlX2ljb25fY2xhc3MiLCJwcm9tcHQiLCJwcm9tcHRfYnV0dG9uX2NsYXNzIiwicHJvbXB0X2ljb25fY2xhc3MiLCJkaXNwbGF5X3NlY29uZHMiLCJzaG93X2NvdW50X2Rvd24iLCJmaXhlZF9wb3NpdGlvbl9vbl9zY3JvbGwiLCJsaW5rIiwiZWxlbWVudCIsImF0dHJzIiwibWVzc2FnZV9jbGFzcyIsInByb21wdF9jbGFzcyIsIndhaXRfdGltZXIiLCJlbGVtZW50X3Zpc2libGVfdGltZXIiLCJlbGVtZW50X3RvcCIsImlzX3Zpc2libGUiLCJkZXRhY2hlZF9wb3NpdGlvbiIsIndpbmRvd19lbGVtZW50IiwidXBkYXRlIiwid2FpdCIsImNvdW50X2Rvd24iLCJjYW5jZWwiLCJjaGVja1Bvc2l0aW9uIiwiaGFzQ2xhc3MiLCJpc051bGwiLCJvZmZzZXRQYXJlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJ1cGRhdGVEZXRhY2hlZCIsInBhZ2VZT2Zmc2V0IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInBhcnNlSW50Iiwib3V0ZXJfcHJvbXB0X2NsYXNzIiwiJHdhdGNoIiwidmFsIiwib24iLCJyZXBsYWNlIiwidGVtcGxhdGVVcmwiLCJjb25zdGFudCJdLCJtYXBwaW5ncyI6IkNBQUEsV0FFQSxZQU1BQSxTQUFBQyxPQUFBLDhCQ1JBRCxRQUFBQyxPQUFBLDJCQUFBQyxLQUFBLGlCQUFBLFNBQUFDLEdBQUFBLEVBQUFDLElBQUEsbUNBQUEsK2JDQUEsV0FFQSxZQU1BLElBQUFDLEdBQUEsU0FBQUMsR0FLQUMsS0FBQUMsUUFBQSxXQUNBLElBQUFDLEVBQUFDLFlBQUFKLEVBQUFFLFNBQUEsQ0FFQSxHQUFBRyxHQUFBRixFQUFBQyxZQUFBSixFQUFBSyxTQUFBLEtBQUFMLEVBQUFLLFFBQ0FDLEVBQUFILEVBQUFDLFlBQUFKLEVBQUFNLE9BQUEsS0FBQU4sRUFBQU0sTUFDQUMsRUFBQUosRUFBQUMsWUFBQUosRUFBQU8sS0FBQSxLQUFBUCxFQUFBTyxJQUNBQyxFQUFBTCxFQUFBQyxZQUFBSixFQUFBUSxNQUFBLEtBQUFSLEVBQUFRLElBRUFSLEdBQUFFLFNBQUFHLFFBQUFBLEVBQUFDLE1BQUFBLEVBQUFDLElBQUFBLEVBQUFDLEtBQUFBLElBRUFSLEVBQUFTLFNBSUFWLEdBQUFXLFNBQUEsVUFFQWhCLFFBQUFDLE9BQUEsd0JBQUFJLFdBQUEsMkJBQUFBLE1DN0JBLFdBRUEsWUFNQSxJQUFBWSxHQUFBLFNBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBZUEsT0FDQUMsU0FBQSxLQUNBQyxPQUNBQyxJQUFBLElBQ0FkLFFBQUEsSUFDQUMsTUFBQSxJQUNBQyxJQUFBLElBQ0FDLEtBQUEsSUFDQVksbUJBQUEsb0JBQ0FDLE9BQUEsSUFDQUMsb0JBQUEscUJBQ0FDLGtCQUFBLG1CQUNBQyxnQkFBQSxrQkFDQUMsZ0JBQUEsaUJBQ0FDLHlCQUFBLHlCQUNBeEIsUUFBQSxrQkFFQUgsV0FBQSxtQ0FDQTRCLEtBQUEsU0FBQVQsRUFBQVUsRUFBQUMsRUFBQTlCLEdBRUEsR0FBQW9CLEdBQUFELEVBQUFDLE9BR0FELEdBQUFZLGNBQUFoQixFQUNBSSxFQUFBYSxhQUFBaEIsQ0FHQSxJQUFBaUIsR0FDQUMsRUFDQUMsQ0FDQWhCLEdBQUFpQixZQUFBLENBR0EsSUFBQUMsR0FDQUMsRUFBQTNDLFFBQUFrQyxRQUFBaEIsRUFNQU8sR0FBQVYsTUFBQSxXQUNBUyxFQUFBVCxTQUdBVSxFQUFBbUIsT0FBQSxXQUNBcEIsRUFBQW9CLFVBVUFwQixFQUFBVCxNQUFBLFdBQ0FTLEVBQUFpQixZQUFBLEdBTUFqQixFQUFBcUIsS0FBQSxXQUVBUCxFQUFBbkIsRUFBQSxXQUVBLE1BQUFLLEVBQUFzQixZQUNBM0IsRUFBQTRCLE9BQUFULEdBQ0FkLEVBQUFULFNBRUFTLEVBQUFxQixRQUVBLE1BTUFyQixFQUFBd0IsY0FBQSxXQUdBeEIsRUFBQWlCLGFBQUFQLEVBQUFlLFNBQUEsYUFBQXhDLEVBQUF5QyxPQUFBaEIsRUFBQSxHQUFBaUIsY0FHQVosRUFBQXBCLEVBQUFLLEVBQUF3QixjQUFBLE1BSUFSLEVBQUFOLEVBQUEsR0FBQWtCLHdCQUFBQyxJQUdBN0IsRUFBQThCLG1CQU9BOUIsRUFBQThCLGVBQUEsV0FHQW5DLEVBQUE0QixPQUFBUixJQUdBTCxFQUFBZSxTQUFBLGFBQUEsR0FBQVQsR0FBQXRCLEVBQUFxQyxZQUFBLEdBQ0FiLEVBQUF4QixFQUFBcUMsWUFDQXJCLEVBQUFzQixTQUFBLGFBR0F0QixFQUFBZSxTQUFBLGNBQUF4QyxFQUFBQyxZQUFBZ0MsSUFBQXhCLEVBQUFxQyxhQUFBYixHQUVBUixFQUFBdUIsWUFBQSxhQU9BakMsRUFBQW9CLE9BQUEsV0FHQXBCLEVBQUFpQixZQUFBLEVBR0FqQixFQUFBUSwwQkFDQVIsRUFBQXdCLGdCQUlBeEIsRUFBQXNCLFdBQUFyQyxFQUFBaUQsU0FBQWxDLEVBQUFNLGlCQUdBWCxFQUFBNEIsT0FBQVQsR0FHQTdCLEVBQUFDLFlBQUFjLEVBQUFzQixhQUFBLElBQUF0QixFQUFBc0IsYUFHQXRCLEVBQUFxQixPQUdBckIsRUFBQW1DLG1CQUFBckMsSUFRQUUsRUFBQW9DLE9BQUEsa0JBQUEsU0FBQUMsR0FFQXBELEVBQUFDLFlBQUFtRCxJQUFBLEtBQUFBLElBQ0FyQyxFQUFBTSxnQkFBQXJCLEVBQUFpRCxTQUFBRyxHQUNBckMsRUFBQXNCLFdBQUFyQyxFQUFBaUQsU0FBQUcsTUFJQXJDLEVBQUFvQyxPQUFBLFVBQUEsU0FBQUMsR0FFQXBELEVBQUFDLFlBQUFtRCxJQUFBLEtBQUFBLEdBR0ExQyxFQUFBNEIsT0FBQVQsR0FDQWQsRUFBQVQsU0FIQVMsRUFBQW9CLFdBT0FwQixFQUFBb0MsT0FBQSxTQUFBLFNBQUFDLEdBR0FwRCxFQUFBQyxZQUFBbUQsSUFBQSxLQUFBQSxFQUdBckMsRUFBQW1DLG1CQUFBLEdBRkFuQyxFQUFBbUMsbUJBQUFyQyxJQVlBRSxFQUFBUSwwQkFDQVcsRUFBQW1CLEdBQUEsU0FBQSxXQUNBckQsRUFBQUMsWUFBQWMsRUFBQWIsVUFBQSxLQUFBYSxFQUFBYixTQUdBYSxFQUFBd0IsbUJBS0FlLFNBQUEsRUFDQUMsWUFBQSxvQ0FJQS9DLEdBQUFELFNBQ0EsVUFDQSxXQUNBLCtCQUNBLHNDQUNBLDJDQUdBaEIsUUFBQUMsT0FBQSx3QkFDQWdCLFVBQUEsdUJBQUFBLE1DM09BLFdBRUEsWUFNQWpCLFNBQUFDLE9BQUEsd0JBQ0FnRSxTQUFBLCtCQUFBLFdBQ0FBLFNBQUEsc0NBQUEsVUFDQUEsU0FBQSwwQ0FBQSIsImZpbGUiOiJhbmd1bGFyLWJldHRlci1tZXNzYWdlLnRtcGwubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBBbmd1bGFyIEJldHRlciBNZXNzYWdlXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQW5ndWxhckJldHRlck1lc3NhZ2UnLCBbXSk7XG5cbn0pKCk7XG4iLCJhbmd1bGFyLm1vZHVsZShcIkFuZ3VsYXJCZXR0ZXJNZXNzYWdlXCIsIFtdKS5ydW4oW1wiJHRlbXBsYXRlQ2FjaGVcIiwgZnVuY3Rpb24oJHRlbXBsYXRlQ2FjaGUpIHskdGVtcGxhdGVDYWNoZS5wdXQoXCJodG1sL2FuZ3VsYXItYmV0dGVyLW1lc3NhZ2UuaHRtbFwiLFwiPGRpdiBjbGFzcz1cXFwiYW5ndWxhci1iZXR0ZXItbWVzc2FnZVxcXCIgbmctY2xhc3M9XFxcIltzdGF0ZSwgb3V0ZXJfcHJvbXB0X2NsYXNzXVxcXCIgbmctc2hvdz1cXFwiaXNfdmlzaWJsZVxcXCI+PGRpdiBuZy1jbGFzcz1cXFwibWVzc2FnZV9jbGFzc1xcXCI+PHNwYW4gbmctY2xhc3M9XFxcIm1lc3NhZ2VfaWNvbl9jbGFzc1xcXCI+PC9zcGFuPiB7e21lc3NhZ2V9fSA8c3BhbiBjbGFzcz1cXFwiY291bnRkb3duXFxcIiBuZy1pZj1cXFwic2hvd19jb3VudF9kb3duXFxcIj57e2NvdW50X2Rvd259fTwvc3Bhbj48L2Rpdj48ZGl2IG5nLWlmPVxcXCJwcm9tcHRcXFwiIG5nLWNsYXNzPVxcXCJwcm9tcHRfY2xhc3NcXFwiPjxidXR0b24gbmctY2xhc3M9XFxcInByb21wdF9idXR0b25fY2xhc3NcXFwiIG5nLWNsaWNrPVxcXCJjdHJsLm9uQ2xpY2soKVxcXCI+e3twcm9tcHR9fSA8c3BhbiBuZy1jbGFzcz1cXFwicHJvbXB0X2ljb25fY2xhc3NcXFwiPjwvc3Bhbj48L2J1dHRvbj48L2Rpdj48L2Rpdj5cIik7fV0pOyIsIihmdW5jdGlvbiAoKSB7XG5cbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIC8vIEFuZ3VsYXIgQmV0dGVyIE1lc3NhZ2UgY29udHJvbGxlclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgdmFyIGNvbnRyb2xsZXIgPSBmdW5jdGlvbiAoJHMpIHtcblxuICAgICAgICAvKipcbiAgICAgICAgICogb25DbGlja1xuICAgICAgICAgKi9cbiAgICAgICAgdGhpcy5vbkNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQoJHMub25DbGljaykpIHtcblxuICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gIV8uaXNVbmRlZmluZWQoJHMubWVzc2FnZSkgPyAkcy5tZXNzYWdlIDogbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSAhXy5pc1VuZGVmaW5lZCgkcy5zdGF0ZSkgPyAkcy5zdGF0ZSA6IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIGtleSA9ICFfLmlzVW5kZWZpbmVkKCRzLmtleSkgPyAkcy5rZXkgOiBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBkYXRhID0gIV8uaXNVbmRlZmluZWQoJHMuZGF0YSkgPyAkcy5kYXRhIDogbnVsbDtcblxuICAgICAgICAgICAgICAgICRzLm9uQ2xpY2soe21lc3NhZ2U6IG1lc3NhZ2UsIHN0YXRlOiBzdGF0ZSwga2V5OiBrZXksIGRhdGE6IGRhdGF9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICRzLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJ107XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQW5ndWxhckJldHRlck1lc3NhZ2UnKS5jb250cm9sbGVyKCdBbmd1bGFyQmV0dGVyTWVzc2FnZUN0cmwnLCBjb250cm9sbGVyKTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gYW5ndWxhci1iZXR0ZXItbWVzc2FnZSBkaXJlY3RpdmVcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgIHZhciBkaXJlY3RpdmUgPSBmdW5jdGlvbihcbiAgICAgICAgJHdpbmRvdyxcbiAgICAgICAgJHRpbWVvdXQsXG4gICAgICAgIE1FU1NBR0VfQ0xBU1MsXG4gICAgICAgIFBST01QVF9DTEFTUyxcbiAgICAgICAgSEFTX1BST01QVF9DTEFTU1xuICAgICkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFBvc2l0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciB4UG9zaXRpb24gPSAwO1xuICAgICAgICAgICAgdmFyIHlQb3NpdGlvbiA9IDA7XG5cbiAgICAgICAgICAgIHdoaWxlKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB4UG9zaXRpb24gKz0gKGVsZW1lbnQub2Zmc2V0TGVmdCAtIGVsZW1lbnQuc2Nyb2xsTGVmdCArIGVsZW1lbnQuY2xpZW50TGVmdCk7XG4gICAgICAgICAgICAgICAgeVBvc2l0aW9uICs9IChlbGVtZW50Lm9mZnNldFRvcCAtIGVsZW1lbnQuc2Nyb2xsVG9wICsgZWxlbWVudC5jbGllbnRUb3ApO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7IHg6IHhQb3NpdGlvbiwgeTogeVBvc2l0aW9uIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGFwaTogICAgICAgICAgICAgICAgICAgIFwiPVwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICAgICAgICAgICAgICAgIFwiPVwiLCAvLyB3aWxsIGJlIHBhc3NlZCBiYWNrIG9uIGV2ZW50c1xuICAgICAgICAgICAgICAgIHN0YXRlOiAgICAgICAgICAgICAgICAgIFwiPVwiLCAvLyB3aWxsIGJlIHBhc3NlZCBiYWNrIG9uIGV2ZW50c1xuICAgICAgICAgICAgICAgIGtleTogICAgICAgICAgICAgICAgICAgIFwiPVwiLCAvLyB3aWxsIGJlIHBhc3NlZCBiYWNrIG9uIGV2ZW50c1xuICAgICAgICAgICAgICAgIGRhdGE6ICAgICAgICAgICAgICAgICAgIFwiPVwiLCAvLyB3aWxsIGJlIHBhc3NlZCBiYWNrIG9uIGV2ZW50c1xuICAgICAgICAgICAgICAgIG1lc3NhZ2VfaWNvbl9jbGFzczogICAgIFwiPW1lc3NhZ2VJY29uQ2xhc3NcIixcbiAgICAgICAgICAgICAgICBwcm9tcHQ6ICAgICAgICAgICAgICAgICBcIj1cIixcbiAgICAgICAgICAgICAgICBwcm9tcHRfYnV0dG9uX2NsYXNzOiAgICBcIj1wcm9tcHRCdXR0b25DbGFzc1wiLFxuICAgICAgICAgICAgICAgIHByb21wdF9pY29uX2NsYXNzOiAgICAgIFwiPXByb21wdEljb25DbGFzc1wiLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlfc2Vjb25kczogICAgICAgIFwiPWRpc3BsYXlTZWNvbmRzXCIsXG4gICAgICAgICAgICAgICAgc2hvd19jb3VudF9kb3duOiAgICAgICAgXCI9c2hvd0NvdW50RG93blwiLFxuICAgICAgICAgICAgICAgIGZpeGVkX3Bvc2l0aW9uX29uX3Njcm9sbDogXCI9Zml4ZWRQb3NpdGlvbk9uU2Nyb2xsXCIsXG4gICAgICAgICAgICAgICAgb25DbGljazogICAgICAgICAgICAgICAgXCImb25Qcm9tcHRDbGlja1wiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY29udHJvbGxlcjogXCJBbmd1bGFyQmV0dGVyTWVzc2FnZUN0cmwgYXMgY3RybFwiLFxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24oc2NvcGUsIGVsZW1lbnQsIGF0dHJzLCBjb250cm9sbGVyKSB7XG5cbiAgICAgICAgICAgICAgICB2YXIgYXBpID0gc2NvcGUuYXBpIHx8IHt9O1xuXG4gICAgICAgICAgICAgICAgLy8gY2xhc3Nlc1xuICAgICAgICAgICAgICAgIHNjb3BlLm1lc3NhZ2VfY2xhc3MgPSBNRVNTQUdFX0NMQVNTO1xuICAgICAgICAgICAgICAgIHNjb3BlLnByb21wdF9jbGFzcyA9IFBST01QVF9DTEFTUztcblxuICAgICAgICAgICAgICAgIC8vIGNvbnRyb2xcbiAgICAgICAgICAgICAgICB2YXIgd2FpdF90aW1lcjtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudF92aXNpYmxlX3RpbWVyO1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50X3RvcDtcbiAgICAgICAgICAgICAgICBzY29wZS5pc192aXNpYmxlID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICAvLyBmaXggb24gc2Nyb2xsXG4gICAgICAgICAgICAgICAgdmFyIGRldGFjaGVkX3Bvc2l0aW9uO1xuICAgICAgICAgICAgICAgIHZhciB3aW5kb3dfZWxlbWVudCA9IGFuZ3VsYXIuZWxlbWVudCgkd2luZG93KTtcblxuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgICAgICAgICAvLyBhcGlcbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgICAgICAgICAgICBhcGkuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgYXBpLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIC8vIHV0aWxzXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogY2xvc2VcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5pc192aXNpYmxlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIHdhaXRcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS53YWl0ID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgd2FpdF90aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoLS1zY29wZS5jb3VudF9kb3duID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHdhaXRfdGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLndhaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIGNoZWNrUG9zaXRpb25cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZWxlbWVudCBpcyB2aXNpYmxlICYgaXMgbm90IGRldGFjaGVkICYgaXMgbm90IHJlYWR5XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5pc192aXNpYmxlICYmICFlbGVtZW50Lmhhc0NsYXNzKCdkZXRhY2hlZCcpICYmIF8uaXNOdWxsKGVsZW1lbnRbMF0ub2Zmc2V0UGFyZW50KSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3YWl0XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50X3Zpc2libGVfdGltZXIgPSAkdGltZW91dChzY29wZS5jaGVja1Bvc2l0aW9uLCAxMDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZWxlbWVudCB0b3Agb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50X3RvcCA9IGVsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZURldGFjaGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogdXBkYXRlRGV0YWNoZWRcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS51cGRhdGVEZXRhY2hlZCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNhbmNlbCB0aW1lclxuICAgICAgICAgICAgICAgICAgICAkdGltZW91dC5jYW5jZWwoZWxlbWVudF92aXNpYmxlX3RpbWVyKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBlbGVtZW50IGlzIG5vdCBkZXRhY2hlZCBhbmQgaXMgYXQgdGhlIHRvcCBvZiB2aWV3cG9ydCwgdGhlbiBkZXRhY2hcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlbGVtZW50Lmhhc0NsYXNzKCdkZXRhY2hlZCcpICYmIGVsZW1lbnRfdG9wIDw9IDAgJiYgJHdpbmRvdy5wYWdlWU9mZnNldCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRldGFjaGVkX3Bvc2l0aW9uID0gJHdpbmRvdy5wYWdlWU9mZnNldDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoJ2RldGFjaGVkJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgLy8gZWxlbWVudCBpcyBkZXRhY2hlZCBhbmQgaXMgYXQgb3IgYWJvdmUgZGV0YWNoZWQgcG9zaXRpb24sIHRoZW4gYXR0YWNoXG4gICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGVsZW1lbnQuaGFzQ2xhc3MoJ2RldGFjaGVkJykgJiYgIV8uaXNVbmRlZmluZWQoZGV0YWNoZWRfcG9zaXRpb24pICYmICR3aW5kb3cucGFnZVlPZmZzZXQgPD0gZGV0YWNoZWRfcG9zaXRpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZGV0YWNoZWRfcG9zaXRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKCdkZXRhY2hlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIHVwZGF0ZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZSA9IGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCB2aXNpYmlsaXR5XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmlzX3Zpc2libGUgPSB0cnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHBvc2l0aW9uXG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5maXhlZF9wb3NpdGlvbl9vbl9zY3JvbGwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNoZWNrUG9zaXRpb24oKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIC8vIHJlc2V0IGNvdW50IGRvd25cbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuY291bnRfZG93biA9IF8ucGFyc2VJbnQoc2NvcGUuZGlzcGxheV9zZWNvbmRzKTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBzdG9wIHRpbWVvdXRcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHdhaXRfdGltZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGF1dG8gY2xvc2UgYWZ0ZXIgaW50ZXJ2YWxcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFfLmlzVW5kZWZpbmVkKHNjb3BlLmNvdW50X2Rvd24pICYmIHNjb3BlLmNvdW50X2Rvd24gIT09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RhcnQgd2FpdFxuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUud2FpdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgb3V0ZXIgcHJvbXQgY2xhc3NcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm91dGVyX3Byb21wdF9jbGFzcyA9IEhBU19QUk9NUFRfQ0xBU1M7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIC8vIHdhdGNoZXJzXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCdkaXNwbGF5X3NlY29uZHMnLCBmdW5jdGlvbih2YWwpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQodmFsKSAmJiB2YWwgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmRpc3BsYXlfc2Vjb25kcyA9IF8ucGFyc2VJbnQodmFsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNvdW50X2Rvd24gPSBfLnBhcnNlSW50KHZhbCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHNjb3BlLiR3YXRjaCgnbWVzc2FnZScsIGZ1bmN0aW9uKHZhbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWwpICYmIHZhbCAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkdGltZW91dC5jYW5jZWwod2FpdF90aW1lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ3Byb21wdCcsIGZ1bmN0aW9uKHZhbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBvdXRlciBwcm9tdCBjbGFzc1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQodmFsKSAmJiB2YWwgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm91dGVyX3Byb21wdF9jbGFzcyA9IEhBU19QUk9NUFRfQ0xBU1M7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vdXRlcl9wcm9tcHRfY2xhc3MgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgLy8gZXZlbnRzXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgICAgICAgICAgLy8gd2luZG93IHNjcm9sbFxuXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLmZpeGVkX3Bvc2l0aW9uX29uX3Njcm9sbCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3dfZWxlbWVudC5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQoc2NvcGUubWVzc2FnZSkgJiYgc2NvcGUubWVzc2FnZSAhPT0gXCJcIikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdodG1sL2FuZ3VsYXItYmV0dGVyLW1lc3NhZ2UuaHRtbCdcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgZGlyZWN0aXZlLiRpbmplY3QgPSBbXG4gICAgICAgICckd2luZG93JyxcbiAgICAgICAgJyR0aW1lb3V0JyxcbiAgICAgICAgJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfQ0xBU1MnLFxuICAgICAgICAnQU5HVUxBUl9CRVRURVJfTUVTU0FHRV9QUk9NUFRfQ0xBU1MnLFxuICAgICAgICAnQU5HVUxBUl9CRVRURVJfTUVTU0FHRV9IQVNfUFJPTVBUX0NMQVNTJ1xuICAgIF07XG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQW5ndWxhckJldHRlck1lc3NhZ2UnKVxuICAgICAgICAuZGlyZWN0aXZlKCdhbmd1bGFyQmV0dGVyTWVzc2FnZScsIGRpcmVjdGl2ZSk7XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBBbmd1bGFyIEJldHRlciBNZXNzYWdlIHNldHRpbmdzXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBhbmd1bGFyLm1vZHVsZSgnQW5ndWxhckJldHRlck1lc3NhZ2UnKVxuICAgICAgICAuY29uc3RhbnQoJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfQ0xBU1MnLCAgICAgICAgICAgICAgIFwibWVzc2FnZVwiKVxuICAgICAgICAuY29uc3RhbnQoJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfUFJPTVBUX0NMQVNTJywgICAgICAgIFwicHJvbXB0XCIpXG4gICAgICAgIC5jb25zdGFudCgnQU5HVUxBUl9CRVRURVJfTUVTU0FHRV9IQVNfUFJPTVBUX0NMQVNTJywgICAgXCJoYXMtcHJvbXB0XCIpO1xuXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
