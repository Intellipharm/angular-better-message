!function(){"use strict";angular.module("AngularBetterMessage",[])}(),function(){"use strict";var e=function(e){this.onClick=function(){if(!_.isUndefined(e.onClick)){var t=_.isUndefined(e.message)?null:e.message,s=_.isUndefined(e.state)?null:e.state,n=_.isUndefined(e.key)?null:e.key,a=_.isUndefined(e.data)?null:e.data;e.onClick({message:t,state:s,key:n,data:a})}e.close()}};e.$inject=["$scope"],angular.module("AngularBetterMessage").controller("AngularBetterMessageCtrl",e)}(),function(){"use strict";var e=function(e,t,s,n,a,o){return{restrict:"EA",scope:{api:"=",message:"=",state:"=",key:"=",data:"=",message_icon_class:"=messageIconClass",prompt:"=",prompt_button_class:"=promptButtonClass",prompt_icon_class:"=promptIconClass",display_seconds:"=displaySeconds",show_count_down:"=showCountDown",fixed_position_on_scroll:"=fixedPositionOnScroll",always_detach:"=alwaysDetach",onClick:"&onPromptClick"},controller:"AngularBetterMessageCtrl as ctrl",link:function(t,i,c,l){var r=t.api||{};t.message_class=n,t.prompt_class=a;var d,u,p;t.is_visible=!1;var f,m=angular.element(e);r.close=function(){t.close()},r.update=function(){t.update()},t.close=function(){t.is_visible=!1},t.wait=function(){d=window.setTimeout(function(){0===--t.count_down?(window.clearTimeout(d),t.close(),t.$apply()):(t.wait(),t.$apply())},1e3)},t.checkPosition=function(){t.is_visible&&!i.hasClass("detached")&&_.isNull(i[0].offsetParent)?u=window.setTimeout(function(){t.checkPosition(),t.$apply()},100):(p=i[0].getBoundingClientRect().top,t.updateDetached())},t.updateDetached=function(){window.clearTimeout(u),t.always_detach&&!i.hasClass("detached")&&0>=p&&e.pageYOffset>0?(f=e.pageYOffset,i.addClass("detached")):i.hasClass("detached")&&!_.isUndefined(f)&&e.pageYOffset<=f&&i.removeClass("detached")},t.update=function(){t.is_visible=!0,t.fixed_position_on_scroll&&t.checkPosition(),t.count_down=_.parseInt(t.display_seconds),window.clearTimeout(d),_.isUndefined(t.count_down)||0===t.count_down||(t.wait(),t.outer_prompt_class=o)},t.$watch("display_seconds",function(e){_.isUndefined(e)||""===e||(t.display_seconds=_.parseInt(e),t.count_down=_.parseInt(e))}),t.$watch("message",function(e){var n=angular.element(i[0].querySelector(".angular-better-message-wrapper"));if(n.empty(),_.isUndefined(e)||""===e)window.clearTimeout(d),t.close();else{var a=s("<span>"+e+"</span>")(t.$parent.$parent);n.append(a),t.update()}}),t.$watch("prompt",function(e){_.isUndefined(e)||""===e?t.outer_prompt_class="":t.outer_prompt_class=o}),t.fixed_position_on_scroll&&m.on("scroll",function(){_.isUndefined(t.message)||""===t.message||t.checkPosition()}),t.updateDetached()},replace:!0,templateUrl:"html/angular-better-message.html"}};e.$inject=["$window","$timeout","$compile","ANGULAR_BETTER_MESSAGE_CLASS","ANGULAR_BETTER_MESSAGE_PROMPT_CLASS","ANGULAR_BETTER_MESSAGE_HAS_PROMPT_CLASS"],angular.module("AngularBetterMessage").directive("angularBetterMessage",e)}(),function(){"use strict";angular.module("AngularBetterMessage").constant("ANGULAR_BETTER_MESSAGE_CLASS","message").constant("ANGULAR_BETTER_MESSAGE_PROMPT_CLASS","prompt").constant("ANGULAR_BETTER_MESSAGE_HAS_PROMPT_CLASS","has-prompt")}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2UuanMiLCJhbmd1bGFyLWJldHRlci1tZXNzYWdlLWNvbnRyb2xsZXIuanMiLCJhbmd1bGFyLWJldHRlci1tZXNzYWdlLWRpcmVjdGl2ZS5qcyIsImFuZ3VsYXItYmV0dGVyLW1lc3NhZ2Utc2V0dGluZ3MuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcyIsInRoaXMiLCJvbkNsaWNrIiwiXyIsImlzVW5kZWZpbmVkIiwibWVzc2FnZSIsInN0YXRlIiwia2V5IiwiZGF0YSIsImNsb3NlIiwiJGluamVjdCIsImRpcmVjdGl2ZSIsIiR3aW5kb3ciLCIkdGltZW91dCIsIiRjb21waWxlIiwiTUVTU0FHRV9DTEFTUyIsIlBST01QVF9DTEFTUyIsIkhBU19QUk9NUFRfQ0xBU1MiLCJyZXN0cmljdCIsInNjb3BlIiwiYXBpIiwibWVzc2FnZV9pY29uX2NsYXNzIiwicHJvbXB0IiwicHJvbXB0X2J1dHRvbl9jbGFzcyIsInByb21wdF9pY29uX2NsYXNzIiwiZGlzcGxheV9zZWNvbmRzIiwic2hvd19jb3VudF9kb3duIiwiZml4ZWRfcG9zaXRpb25fb25fc2Nyb2xsIiwiYWx3YXlzX2RldGFjaCIsImxpbmsiLCJlbGVtZW50IiwiYXR0cnMiLCJtZXNzYWdlX2NsYXNzIiwicHJvbXB0X2NsYXNzIiwid2FpdF90aW1lciIsImVsZW1lbnRfdmlzaWJsZV90aW1lciIsImVsZW1lbnRfdG9wIiwiaXNfdmlzaWJsZSIsImRldGFjaGVkX3Bvc2l0aW9uIiwid2luZG93X2VsZW1lbnQiLCJ1cGRhdGUiLCJ3YWl0Iiwid2luZG93Iiwic2V0VGltZW91dCIsImNvdW50X2Rvd24iLCJjbGVhclRpbWVvdXQiLCIkYXBwbHkiLCJjaGVja1Bvc2l0aW9uIiwiaGFzQ2xhc3MiLCJpc051bGwiLCJvZmZzZXRQYXJlbnQiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ0b3AiLCJ1cGRhdGVEZXRhY2hlZCIsInBhZ2VZT2Zmc2V0IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsInBhcnNlSW50Iiwib3V0ZXJfcHJvbXB0X2NsYXNzIiwiJHdhdGNoIiwidmFsIiwid3JhcHBlciIsInF1ZXJ5U2VsZWN0b3IiLCJlbXB0eSIsImNvbXBpbGVkX21lc3NhZ2UiLCIkcGFyZW50IiwiYXBwZW5kIiwib24iLCJyZXBsYWNlIiwidGVtcGxhdGVVcmwiLCJjb25zdGFudCJdLCJtYXBwaW5ncyI6IkNBQUEsV0FFQSxZQU1BQSxTQUFBQyxPQUFBLDhCQ1JBLFdBRUEsWUFNQSxJQUFBQyxHQUFBLFNBQUFDLEdBS0FDLEtBQUFDLFFBQUEsV0FDQSxJQUFBQyxFQUFBQyxZQUFBSixFQUFBRSxTQUFBLENBRUEsR0FBQUcsR0FBQUYsRUFBQUMsWUFBQUosRUFBQUssU0FBQSxLQUFBTCxFQUFBSyxRQUNBQyxFQUFBSCxFQUFBQyxZQUFBSixFQUFBTSxPQUFBLEtBQUFOLEVBQUFNLE1BQ0FDLEVBQUFKLEVBQUFDLFlBQUFKLEVBQUFPLEtBQUEsS0FBQVAsRUFBQU8sSUFDQUMsRUFBQUwsRUFBQUMsWUFBQUosRUFBQVEsTUFBQSxLQUFBUixFQUFBUSxJQUVBUixHQUFBRSxTQUFBRyxRQUFBQSxFQUFBQyxNQUFBQSxFQUFBQyxJQUFBQSxFQUFBQyxLQUFBQSxJQUVBUixFQUFBUyxTQUlBVixHQUFBVyxTQUFBLFVBRUFiLFFBQUFDLE9BQUEsd0JBQUFDLFdBQUEsMkJBQUFBLE1DN0JBLFdBRUEsWUFNQSxJQUFBWSxHQUFBLFNBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBZUEsT0FDQUMsU0FBQSxLQUNBQyxPQUNBQyxJQUFBLElBQ0FmLFFBQUEsSUFDQUMsTUFBQSxJQUNBQyxJQUFBLElBQ0FDLEtBQUEsSUFDQWEsbUJBQUEsb0JBQ0FDLE9BQUEsSUFDQUMsb0JBQUEscUJBQ0FDLGtCQUFBLG1CQUNBQyxnQkFBQSxrQkFDQUMsZ0JBQUEsaUJBQ0FDLHlCQUFBLHlCQUNBQyxjQUFBLGdCQUNBMUIsUUFBQSxrQkFFQUgsV0FB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Q0FBQSIsImZpbGUiOiJhbmd1bGFyLWJldHRlci1tZXNzYWdlLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQW5ndWxhciBCZXR0ZXIgTWVzc2FnZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlJywgW10pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQW5ndWxhciBCZXR0ZXIgTWVzc2FnZSBjb250cm9sbGVyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICB2YXIgY29udHJvbGxlciA9IGZ1bmN0aW9uICgkcykge1xuXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBvbkNsaWNrXG4gICAgICAgICAqL1xuICAgICAgICB0aGlzLm9uQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCgkcy5vbkNsaWNrKSkge1xuXG4gICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2UgPSAhXy5pc1VuZGVmaW5lZCgkcy5tZXNzYWdlKSA/ICRzLm1lc3NhZ2UgOiBudWxsO1xuICAgICAgICAgICAgICAgIHZhciBzdGF0ZSA9ICFfLmlzVW5kZWZpbmVkKCRzLnN0YXRlKSA/ICRzLnN0YXRlIDogbnVsbDtcbiAgICAgICAgICAgICAgICB2YXIga2V5ID0gIV8uaXNVbmRlZmluZWQoJHMua2V5KSA/ICRzLmtleSA6IG51bGw7XG4gICAgICAgICAgICAgICAgdmFyIGRhdGEgPSAhXy5pc1VuZGVmaW5lZCgkcy5kYXRhKSA/ICRzLmRhdGEgOiBudWxsO1xuXG4gICAgICAgICAgICAgICAgJHMub25DbGljayh7bWVzc2FnZTogbWVzc2FnZSwgc3RhdGU6IHN0YXRlLCBrZXk6IGtleSwgZGF0YTogZGF0YX0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgJHMuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgY29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnXTtcblxuICAgIGFuZ3VsYXIubW9kdWxlKCdBbmd1bGFyQmV0dGVyTWVzc2FnZScpLmNvbnRyb2xsZXIoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlQ3RybCcsIGNvbnRyb2xsZXIpO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvLyBhbmd1bGFyLWJldHRlci1tZXNzYWdlIGRpcmVjdGl2ZVxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgdmFyIGRpcmVjdGl2ZSA9IGZ1bmN0aW9uKFxuICAgICAgICAkd2luZG93LFxuICAgICAgICAkdGltZW91dCxcbiAgICAgICAgJGNvbXBpbGUsXG4gICAgICAgIE1FU1NBR0VfQ0xBU1MsXG4gICAgICAgIFBST01QVF9DTEFTUyxcbiAgICAgICAgSEFTX1BST01QVF9DTEFTU1xuICAgICkge1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldFBvc2l0aW9uKGVsZW1lbnQpIHtcbiAgICAgICAgICAgIHZhciB4UG9zaXRpb24gPSAwO1xuICAgICAgICAgICAgdmFyIHlQb3NpdGlvbiA9IDA7XG5cbiAgICAgICAgICAgIHdoaWxlKGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICB4UG9zaXRpb24gKz0gKGVsZW1lbnQub2Zmc2V0TGVmdCAtIGVsZW1lbnQuc2Nyb2xsTGVmdCArIGVsZW1lbnQuY2xpZW50TGVmdCk7XG4gICAgICAgICAgICAgICAgeVBvc2l0aW9uICs9IChlbGVtZW50Lm9mZnNldFRvcCAtIGVsZW1lbnQuc2Nyb2xsVG9wICsgZWxlbWVudC5jbGllbnRUb3ApO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSBlbGVtZW50Lm9mZnNldFBhcmVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB7IHg6IHhQb3NpdGlvbiwgeTogeVBvc2l0aW9uIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIGFwaTogICAgICAgICAgICAgICAgICAgICAgXCI9XCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogICAgICAgICAgICAgICAgICBcIj1cIiwgLy8gd2lsbCBiZSBwYXNzZWQgYmFjayBvbiBldmVudHNcbiAgICAgICAgICAgICAgICBzdGF0ZTogICAgICAgICAgICAgICAgICAgIFwiPVwiLCAvLyB3aWxsIGJlIHBhc3NlZCBiYWNrIG9uIGV2ZW50c1xuICAgICAgICAgICAgICAgIGtleTogICAgICAgICAgICAgICAgICAgICAgXCI9XCIsIC8vIHdpbGwgYmUgcGFzc2VkIGJhY2sgb24gZXZlbnRzXG4gICAgICAgICAgICAgICAgZGF0YTogICAgICAgICAgICAgICAgICAgICBcIj1cIiwgLy8gd2lsbCBiZSBwYXNzZWQgYmFjayBvbiBldmVudHNcbiAgICAgICAgICAgICAgICBtZXNzYWdlX2ljb25fY2xhc3M6ICAgICAgIFwiPW1lc3NhZ2VJY29uQ2xhc3NcIixcbiAgICAgICAgICAgICAgICBwcm9tcHQ6ICAgICAgICAgICAgICAgICAgIFwiPVwiLFxuICAgICAgICAgICAgICAgIHByb21wdF9idXR0b25fY2xhc3M6ICAgICAgXCI9cHJvbXB0QnV0dG9uQ2xhc3NcIixcbiAgICAgICAgICAgICAgICBwcm9tcHRfaWNvbl9jbGFzczogICAgICAgIFwiPXByb21wdEljb25DbGFzc1wiLFxuICAgICAgICAgICAgICAgIGRpc3BsYXlfc2Vjb25kczogICAgICAgICAgXCI9ZGlzcGxheVNlY29uZHNcIixcbiAgICAgICAgICAgICAgICBzaG93X2NvdW50X2Rvd246ICAgICAgICAgIFwiPXNob3dDb3VudERvd25cIixcbiAgICAgICAgICAgICAgICBmaXhlZF9wb3NpdGlvbl9vbl9zY3JvbGw6IFwiPWZpeGVkUG9zaXRpb25PblNjcm9sbFwiLFxuICAgICAgICAgICAgICAgIGFsd2F5c19kZXRhY2g6ICAgICAgICAgICAgXCI9YWx3YXlzRGV0YWNoXCIsXG4gICAgICAgICAgICAgICAgb25DbGljazogICAgICAgICAgICAgICAgICBcIiZvblByb21wdENsaWNrXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjb250cm9sbGVyOiBcIkFuZ3VsYXJCZXR0ZXJNZXNzYWdlQ3RybCBhcyBjdHJsXCIsXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbihzY29wZSwgZWxlbWVudCwgYXR0cnMsIGNvbnRyb2xsZXIpIHtcblxuICAgICAgICAgICAgICAgIHZhciBhcGkgPSBzY29wZS5hcGkgfHwge307XG5cbiAgICAgICAgICAgICAgICAvLyBjbGFzc2VzXG4gICAgICAgICAgICAgICAgc2NvcGUubWVzc2FnZV9jbGFzcyA9IE1FU1NBR0VfQ0xBU1M7XG4gICAgICAgICAgICAgICAgc2NvcGUucHJvbXB0X2NsYXNzID0gUFJPTVBUX0NMQVNTO1xuXG4gICAgICAgICAgICAgICAgLy8gY29udHJvbFxuICAgICAgICAgICAgICAgIHZhciB3YWl0X3RpbWVyO1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50X3Zpc2libGVfdGltZXI7XG4gICAgICAgICAgICAgICAgdmFyIGVsZW1lbnRfdG9wO1xuICAgICAgICAgICAgICAgIHNjb3BlLmlzX3Zpc2libGUgPSBmYWxzZTtcblxuICAgICAgICAgICAgICAgIC8vIGZpeCBvbiBzY3JvbGxcbiAgICAgICAgICAgICAgICB2YXIgZGV0YWNoZWRfcG9zaXRpb247XG4gICAgICAgICAgICAgICAgdmFyIHdpbmRvd19lbGVtZW50ID0gYW5ndWxhci5lbGVtZW50KCR3aW5kb3cpO1xuXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgICAgICAgICAgICAgIC8vIGFwaVxuICAgICAgICAgICAgICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblxuICAgICAgICAgICAgICAgIGFwaS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBzY29wZS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBhcGkudXBkYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZSgpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgLy8gdXRpbHNcbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiBjbG9zZVxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHNjb3BlLmNsb3NlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmlzX3Zpc2libGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogd2FpdFxuICAgICAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgICAgIHNjb3BlLndhaXQgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAvL3dhaXRfdGltZXIgPSAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9cbiAgICAgICAgICAgICAgICAgICAgLy8gICAgaWYgKC0tc2NvcGUuY291bnRfZG93biA9PT0gMCkge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHdhaXRfdGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgICAgc2NvcGUuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgICAgIHNjb3BlLndhaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgfVxuICAgICAgICAgICAgICAgICAgICAvL30sIDEwMDApO1xuICAgICAgICAgICAgICAgICAgICB3YWl0X3RpbWVyID0gd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgtLXNjb3BlLmNvdW50X2Rvd24gPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHdhaXRfdGltZXIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLndhaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS4kYXBwbHkoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICAgICAqIGNoZWNrUG9zaXRpb25cbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uID0gZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gZWxlbWVudCBpcyB2aXNpYmxlICYgaXMgbm90IGRldGFjaGVkICYgaXMgbm90IHJlYWR5XG4gICAgICAgICAgICAgICAgICAgIGlmIChzY29wZS5pc192aXNpYmxlICYmICFlbGVtZW50Lmhhc0NsYXNzKCdkZXRhY2hlZCcpICYmIF8uaXNOdWxsKGVsZW1lbnRbMF0ub2Zmc2V0UGFyZW50KSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3YWl0XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50X3Zpc2libGVfdGltZXIgPSB3aW5kb3cuc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9LCAxMDApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZWxlbWVudCB0b3Agb2Zmc2V0XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50X3RvcCA9IGVsZW1lbnRbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkudG9wO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB1cGRhdGVcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZURldGFjaGVkKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgICAgICogdXBkYXRlRGV0YWNoZWRcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS51cGRhdGVEZXRhY2hlZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAvLyBjYW5jZWwgdGltZXJcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmNsZWFyVGltZW91dChlbGVtZW50X3Zpc2libGVfdGltZXIpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaXMgbm90IGRldGFjaGVkIGFuZCBpcyBhdCB0aGUgdG9wIG9mIHZpZXdwb3J0LCB0aGVuIGRldGFjaFxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuYWx3YXlzX2RldGFjaCAmJiAhZWxlbWVudC5oYXNDbGFzcygnZGV0YWNoZWQnKSAmJiBlbGVtZW50X3RvcCA8PSAwICYmICR3aW5kb3cucGFnZVlPZmZzZXQgPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZXRhY2hlZF9wb3NpdGlvbiA9ICR3aW5kb3cucGFnZVlPZmZzZXQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdkZXRhY2hlZCcpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIC8vIGVsZW1lbnQgaXMgZGV0YWNoZWQgYW5kIGlzIGF0IG9yIGFib3ZlIGRldGFjaGVkIHBvc2l0aW9uLCB0aGVuIGF0dGFjaFxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlbGVtZW50Lmhhc0NsYXNzKCdkZXRhY2hlZCcpICYmICFfLmlzVW5kZWZpbmVkKGRldGFjaGVkX3Bvc2l0aW9uKSAmJiAkd2luZG93LnBhZ2VZT2Zmc2V0IDw9IGRldGFjaGVkX3Bvc2l0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2RldGFjaGVkX3Bvc2l0aW9uID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZGV0YWNoZWQnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAgICAgKiB1cGRhdGVcbiAgICAgICAgICAgICAgICAgKi9cbiAgICAgICAgICAgICAgICBzY29wZS51cGRhdGUgPSBmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBzZXQgdmlzaWJpbGl0eVxuICAgICAgICAgICAgICAgICAgICBzY29wZS5pc192aXNpYmxlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBwb3NpdGlvblxuICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcGUuZml4ZWRfcG9zaXRpb25fb25fc2Nyb2xsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAvLyByZXNldCBjb3VudCBkb3duXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLmNvdW50X2Rvd24gPSBfLnBhcnNlSW50KHNjb3BlLmRpc3BsYXlfc2Vjb25kcyk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gc3RvcCB0aW1lb3V0XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQod2FpdF90aW1lcik7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gYXV0byBjbG9zZSBhZnRlciBpbnRlcnZhbFxuICAgICAgICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQoc2NvcGUuY291bnRfZG93bikgJiYgc2NvcGUuY291bnRfZG93biAhPT0gMCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzdGFydCB3YWl0XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS53YWl0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBvdXRlciBwcm9tdCBjbGFzc1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUub3V0ZXJfcHJvbXB0X2NsYXNzID0gSEFTX1BST01QVF9DTEFTUztcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgLy8gd2F0Y2hlcnNcbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ2Rpc3BsYXlfc2Vjb25kcycsIGZ1bmN0aW9uKHZhbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWwpICYmIHZhbCAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuZGlzcGxheV9zZWNvbmRzID0gXy5wYXJzZUludCh2YWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2NvcGUuY291bnRfZG93biA9IF8ucGFyc2VJbnQodmFsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgc2NvcGUuJHdhdGNoKCdtZXNzYWdlJywgZnVuY3Rpb24odmFsKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB3cmFwcGVyID0gYW5ndWxhci5lbGVtZW50KGVsZW1lbnRbMF0ucXVlcnlTZWxlY3RvcignLmFuZ3VsYXItYmV0dGVyLW1lc3NhZ2Utd3JhcHBlcicpKTtcbiAgICAgICAgICAgICAgICAgICAgd3JhcHBlci5lbXB0eSgpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICghXy5pc1VuZGVmaW5lZCh2YWwpICYmIHZhbCAhPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbXBpbGVkX21lc3NhZ2UgPSAkY29tcGlsZSgnPHNwYW4+JyArIHZhbCArICc8L3NwYW4+Jykoc2NvcGUuJHBhcmVudC4kcGFyZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdyYXBwZXIuYXBwZW5kKGNvbXBpbGVkX21lc3NhZ2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS51cGRhdGUoKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHdpbmRvdy5jbGVhclRpbWVvdXQod2FpdF90aW1lcik7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBzY29wZS4kd2F0Y2goJ3Byb21wdCcsIGZ1bmN0aW9uKHZhbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIHNldCBvdXRlciBwcm9tdCBjbGFzc1xuICAgICAgICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQodmFsKSAmJiB2YWwgIT09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLm91dGVyX3Byb21wdF9jbGFzcyA9IEhBU19QUk9NUFRfQ0xBU1M7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5vdXRlcl9wcm9tcHRfY2xhc3MgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgICAgICAgLy8gZXZlbnRzXG4gICAgICAgICAgICAgICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgICAgICAgICAgICAgLy8gd2luZG93IHNjcm9sbFxuXG4gICAgICAgICAgICAgICAgaWYgKHNjb3BlLmZpeGVkX3Bvc2l0aW9uX29uX3Njcm9sbCkge1xuICAgICAgICAgICAgICAgICAgICB3aW5kb3dfZWxlbWVudC5vbignc2Nyb2xsJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIV8uaXNVbmRlZmluZWQoc2NvcGUubWVzc2FnZSkgJiYgc2NvcGUubWVzc2FnZSAhPT0gXCJcIikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgcG9zaXRpb25cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZS5jaGVja1Bvc2l0aW9uKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNjb3BlLnVwZGF0ZURldGFjaGVkKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnaHRtbC9hbmd1bGFyLWJldHRlci1tZXNzYWdlLmh0bWwnXG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGRpcmVjdGl2ZS4kaW5qZWN0ID0gW1xuICAgICAgICAnJHdpbmRvdycsXG4gICAgICAgICckdGltZW91dCcsXG4gICAgICAgICckY29tcGlsZScsXG4gICAgICAgICdBTkdVTEFSX0JFVFRFUl9NRVNTQUdFX0NMQVNTJyxcbiAgICAgICAgJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfUFJPTVBUX0NMQVNTJyxcbiAgICAgICAgJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfSEFTX1BST01QVF9DTEFTUydcbiAgICBdO1xuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnYW5ndWxhckJldHRlck1lc3NhZ2UnLCBkaXJlY3RpdmUpO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uICgpIHtcblxuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy8gQW5ndWxhciBCZXR0ZXIgTWVzc2FnZSBzZXR0aW5nc1xuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gICAgYW5ndWxhci5tb2R1bGUoJ0FuZ3VsYXJCZXR0ZXJNZXNzYWdlJylcbiAgICAgICAgLmNvbnN0YW50KCdBTkdVTEFSX0JFVFRFUl9NRVNTQUdFX0NMQVNTJywgICAgICAgICAgICAgICBcIm1lc3NhZ2VcIilcbiAgICAgICAgLmNvbnN0YW50KCdBTkdVTEFSX0JFVFRFUl9NRVNTQUdFX1BST01QVF9DTEFTUycsICAgICAgICBcInByb21wdFwiKVxuICAgICAgICAuY29uc3RhbnQoJ0FOR1VMQVJfQkVUVEVSX01FU1NBR0VfSEFTX1BST01QVF9DTEFTUycsICAgIFwiaGFzLXByb21wdFwiKTtcblxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
